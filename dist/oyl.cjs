"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./index-Dfqe4I64.cjs"),f=require("bitcoinjs-lib");require("./index.cjs");const g=require("./BrowserWalletNetworkMismatchError-CDpdIBHK.cjs");function w(){if(typeof window>"u")throw new e.OrditSDKError("Cannot call this function outside a browser");return typeof window.oyl<"u"}function d(n="mainnet"){if(!w())throw new e.BrowserWalletNotInstalledError("Oyl Wallet not installed");if(n!=="mainnet")throw new g.BrowserWalletNetworkMismatchError("Oyl Wallet only supports mainnet")}async function h(n="mainnet"){d(n);const r=await window.oyl.getAddresses(),o=[];if(!r.taproot)throw new e.OrditSDKError("No taproot address found");return Object.keys(r).forEach(s=>{const i=s;o.push({publicKey:r[i].publicKey,address:r[i].address,format:e.getAddressFormat(r[i].address,n)})}),o}async function b(n,r,o="mainnet"){d(o);try{const{signature:s}=await window.oyl.signMessage({address:r,message:n});return{hex:e.Buffer.from(s,"base64").toString("hex"),base64:s}}catch(s){throw console.error("Sign message error",s),new e.OrditSDKError("Failed to sign message with Oyl Wallet")}}async function y(n,{finalize:r=!0,extractTx:o=!0,network:s,inputsToSign:i}={network:"mainnet",inputsToSign:[]}){if(d(s),o&&!r)throw new e.BrowserWalletExtractTxFromNonFinalizedPsbtError;const c=[];i.forEach(t=>{const{signingIndexes:l}=t;l.forEach(()=>{c.push(t)})});let a;try{const{psbt:t}=await window.oyl.signPsbt({psbt:n.toHex(),finalize:!1,broadcast:!1});a=f.Psbt.fromHex(t)}catch{throw new e.OrditSDKError("Failed to sign psbt with Oyl Wallet")}if(r&&c.forEach((t,l)=>{try{a.finalizeInput(l)}catch(u){throw console.error("Sign psbt error",u),new e.OrditSDKError("Failed to finalize input")}}),o)try{return{base64:null,hex:a.extractTransaction().toHex()}}catch(t){throw t instanceof Error&&t.message==="Not finalized"?new e.BrowserWalletExtractTxFromNonFinalizedPsbtError:new e.OrditSDKError("Failed to extract transaction from PSBT")}return{hex:a.toHex(),base64:a.toBase64()}}exports.getAddresses=h;exports.isInstalled=w;exports.signMessage=b;exports.signPsbt=y;
